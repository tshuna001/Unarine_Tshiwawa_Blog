<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Supervised Machine Learning: Regression Task (maximum Temperature Prediction)</title>
  <meta name="description" content="import pandas as pdimport matplotlib.pylab as pltimport numpy as np%matplotlib inlineimport osfrom IPython.display import displayimport seaborn as sns; sns.s...">

  <link rel="stylesheet" href="/Unarine_Tshiwawa_Blog/css/main.css">
  <link rel="canonical" href="http://localhost:4000/Unarine_Tshiwawa_Blog/2020/01/14/Supervised-Machine-Learning-Regression-Task-(maximum-temperature-prediction).html">
  <link rel="alternate" type="application/rss+xml" title="Unarine Tshiwawa" href="http://localhost:4000/Unarine_Tshiwawa_Blog/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/Unarine_Tshiwawa_Blog/">Unarine Tshiwawa</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/Unarine_Tshiwawa_Blog/about/">About</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Supervised Machine Learning: Regression Task (maximum Temperature Prediction)</h1>
    <p class="post-meta"><time datetime="2020-01-14T00:00:00+02:00" itemprop="datePublished">Jan 14, 2020</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Unarine Tshiwawa</span></span></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span><span class="p">;</span> <span class="n">sns</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="s">'notebook'</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas_profiling</span>
</code></pre></div></div>

<h3 id="dataset">Dataset:</h3>

<p>Define the problem: We want to establish linear relationship between minimum temperature and maximum temperature in Barajas Airport in Madrid, between 1997 and 2015. The dataset in this work comes from <a href="https://www.kaggle.com/juliansimon/weather_madrid_lemd_1997_2015.csv">Kaggle</a></p>

<h4 id="main-point-we-are-trying-to-build-a-linear-model-that-will-predict-maximum-temperature-from-minimum-temperature">Main point: we are trying to build a linear model that will predict maximum temperature from minimum temperature.</h4>

<p>Clearly, we see that this is a supervised machine leaning - regression - type of a problem.  An output to this problem is a continuous quantity.</p>

<h3 id="read-dataset">Read dataset</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">file</span> <span class="o">=</span> <span class="s">'/home/unarine/Downloads/weather_madrid_lemd_1997_2015.csv.zip'</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="nb">file</span><span class="p">,</span> <span class="n">compression</span> <span class="o">=</span> <span class="s">'zip'</span><span class="p">)</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></div>

<p>Dataset information:</p>

<p>The info() method is useful to get a quick description of the data</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 6812 entries, 0 to 6811
Data columns (total 23 columns):
CET                            6812 non-null object
Max TemperatureC               6810 non-null float64
Mean TemperatureC              6809 non-null float64
Min TemperatureC               6810 non-null float64
Dew PointC                     6810 non-null float64
MeanDew PointC                 6810 non-null float64
Min DewpointC                  6810 non-null float64
Max Humidity                   6810 non-null float64
 Mean Humidity                 6810 non-null float64
 Min Humidity                  6810 non-null float64
 Max Sea Level PressurehPa     6812 non-null int64
 Mean Sea Level PressurehPa    6812 non-null int64
 Min Sea Level PressurehPa     6812 non-null int64
 Max VisibilityKm              5872 non-null float64
 Mean VisibilityKm             5872 non-null float64
 Min VisibilitykM              5872 non-null float64
 Max Wind SpeedKm/h            6812 non-null int64
 Mean Wind SpeedKm/h           6812 non-null int64
 Max Gust SpeedKm/h            3506 non-null float64
Precipitationmm                6812 non-null float64
 CloudCover                    5440 non-null float64
 Events                        1798 non-null object
WindDirDegrees                 6812 non-null int64
dtypes: float64(15), int64(6), object(2)
memory usage: 1.2+ MB



None
</code></pre></div></div>

<ul>
  <li>
    <p>NB: There are 6812 instances in the dataset, which means that it is very small by Machine Learning standards, but it’s perfect to get started.</p>
  </li>
  <li>
    <p>All attributes are numerical, except the <code class="highlighter-rouge">CET</code> and <code class="highlighter-rouge">Events</code> field</p>
  </li>
</ul>

<p>Shape of dataset:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df1</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(6812, 23)
</code></pre></div></div>

<p>Features of each instance in the dataset:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df1</span><span class="o">.</span><span class="n">columns</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['CET', 'Max TemperatureC', 'Mean TemperatureC', 'Min TemperatureC',
       'Dew PointC', 'MeanDew PointC', 'Min DewpointC', 'Max Humidity',
       ' Mean Humidity', ' Min Humidity', ' Max Sea Level PressurehPa',
       ' Mean Sea Level PressurehPa', ' Min Sea Level PressurehPa',
       ' Max VisibilityKm', ' Mean VisibilityKm', ' Min VisibilitykM',
       ' Max Wind SpeedKm/h', ' Mean Wind SpeedKm/h', ' Max Gust SpeedKm/h',
       'Precipitationmm', ' CloudCover', ' Events', 'WindDirDegrees'],
      dtype='object')
</code></pre></div></div>

<h3 id="take-a-quick-look-at-the-data-structure">Take a Quick Look at the Data Structure</h3>

<p>Let’s take a look at the top five rows using the DataFrame’s head() method</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CET</th>
      <th>Max TemperatureC</th>
      <th>Mean TemperatureC</th>
      <th>Min TemperatureC</th>
      <th>Dew PointC</th>
      <th>MeanDew PointC</th>
      <th>Min DewpointC</th>
      <th>Max Humidity</th>
      <th>Mean Humidity</th>
      <th>Min Humidity</th>
      <th>...</th>
      <th>Max VisibilityKm</th>
      <th>Mean VisibilityKm</th>
      <th>Min VisibilitykM</th>
      <th>Max Wind SpeedKm/h</th>
      <th>Mean Wind SpeedKm/h</th>
      <th>Max Gust SpeedKm/h</th>
      <th>Precipitationmm</th>
      <th>CloudCover</th>
      <th>Events</th>
      <th>WindDirDegrees</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1997-1-1</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>95.0</td>
      <td>76.0</td>
      <td>...</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>4.0</td>
      <td>13</td>
      <td>6</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>229</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1997-1-2</td>
      <td>7.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>92.0</td>
      <td>71.0</td>
      <td>...</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>4.0</td>
      <td>26</td>
      <td>8</td>
      <td>47.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>Rain</td>
      <td>143</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1997-1-3</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>-1.0</td>
      <td>100.0</td>
      <td>85.0</td>
      <td>70.0</td>
      <td>...</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>7.0</td>
      <td>27</td>
      <td>19</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>Rain-Snow</td>
      <td>256</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1997-1-4</td>
      <td>7.0</td>
      <td>3.0</td>
      <td>-1.0</td>
      <td>-2.0</td>
      <td>-3.0</td>
      <td>-4.0</td>
      <td>86.0</td>
      <td>63.0</td>
      <td>49.0</td>
      <td>...</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>27</td>
      <td>19</td>
      <td>40.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>284</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1997-1-5</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>-1.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>-3.0</td>
      <td>100.0</td>
      <td>95.0</td>
      <td>86.0</td>
      <td>...</td>
      <td>10.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>14</td>
      <td>6</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>Snow</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1997-1-6</td>
      <td>7.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>-1.0</td>
      <td>-3.0</td>
      <td>100.0</td>
      <td>82.0</td>
      <td>57.0</td>
      <td>...</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>11</td>
      <td>5</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>NaN</td>
      <td>64</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1997-1-7</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>-2.0</td>
      <td>1.0</td>
      <td>-1.0</td>
      <td>-3.0</td>
      <td>100.0</td>
      <td>93.0</td>
      <td>75.0</td>
      <td>...</td>
      <td>10.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>6</td>
      <td>2</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>Snow</td>
      <td>43</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1997-1-8</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>100.0</td>
      <td>96.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>26</td>
      <td>8</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>Rain</td>
      <td>273</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 23 columns</p>
</div>

<p>When looking at the top five rows, you probably noticed that the inputs in the <code class="highlighter-rouge">Events</code> column are repetitive,
which means that it is probably a categorical attribute. So we can find out what categories exist and how many weather events belong to each category by using the value_counts() method:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df1</span><span class="p">[</span><span class="s">' Events'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Rain                      1140
Rain-Thunderstorm          247
Fog                        233
Fog-Rain                    69
Thunderstorm                45
Rain-Snow                   33
Snow                        14
Rain-Hail-Thunderstorm       7
Fog-Snow                     4
Tornado                      1
Rain-Hail                    1
Fog-Rain-Thunderstorm        1
Rain-Snow-Thunderstorm       1
Fog-Thunderstorm             1
Fog-Rain-Snow                1
Name:  Events, dtype: int64
</code></pre></div></div>

<p>Basic statistics: Summary of each numerical attribute.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Max TemperatureC</th>
      <th>Mean TemperatureC</th>
      <th>Min TemperatureC</th>
      <th>Dew PointC</th>
      <th>MeanDew PointC</th>
      <th>Min DewpointC</th>
      <th>Max Humidity</th>
      <th>Mean Humidity</th>
      <th>Min Humidity</th>
      <th>Max Sea Level PressurehPa</th>
      <th>...</th>
      <th>Min Sea Level PressurehPa</th>
      <th>Max VisibilityKm</th>
      <th>Mean VisibilityKm</th>
      <th>Min VisibilitykM</th>
      <th>Max Wind SpeedKm/h</th>
      <th>Mean Wind SpeedKm/h</th>
      <th>Max Gust SpeedKm/h</th>
      <th>Precipitationmm</th>
      <th>CloudCover</th>
      <th>WindDirDegrees</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>6810.000000</td>
      <td>6809.000000</td>
      <td>6810.000000</td>
      <td>6810.000000</td>
      <td>6810.000000</td>
      <td>6810.000000</td>
      <td>6810.000000</td>
      <td>6810.000000</td>
      <td>6810.000000</td>
      <td>6812.000000</td>
      <td>...</td>
      <td>6812.000000</td>
      <td>5872.000000</td>
      <td>5872.000000</td>
      <td>5872.000000</td>
      <td>6812.000000</td>
      <td>6812.000000</td>
      <td>3506.000000</td>
      <td>6812.000000</td>
      <td>5440.000000</td>
      <td>6812.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>21.039648</td>
      <td>14.658687</td>
      <td>8.640529</td>
      <td>8.120705</td>
      <td>4.976211</td>
      <td>1.451248</td>
      <td>81.139354</td>
      <td>57.971366</td>
      <td>34.729369</td>
      <td>1020.529360</td>
      <td>...</td>
      <td>1015.217410</td>
      <td>14.644074</td>
      <td>11.719857</td>
      <td>9.134877</td>
      <td>21.953171</td>
      <td>9.170728</td>
      <td>43.988306</td>
      <td>0.111182</td>
      <td>3.206066</td>
      <td>197.234586</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8.867187</td>
      <td>7.580461</td>
      <td>6.837626</td>
      <td>4.741067</td>
      <td>4.654270</td>
      <td>4.909705</td>
      <td>17.531839</td>
      <td>19.675744</td>
      <td>19.320359</td>
      <td>6.235941</td>
      <td>...</td>
      <td>6.944745</td>
      <td>8.770024</td>
      <td>5.592324</td>
      <td>5.075065</td>
      <td>9.903914</td>
      <td>5.110013</td>
      <td>12.252462</td>
      <td>0.967174</td>
      <td>1.808948</td>
      <td>119.872777</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>-3.000000</td>
      <td>-10.000000</td>
      <td>-12.000000</td>
      <td>-15.000000</td>
      <td>-22.000000</td>
      <td>16.000000</td>
      <td>15.000000</td>
      <td>4.000000</td>
      <td>994.000000</td>
      <td>...</td>
      <td>965.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>19.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>13.000000</td>
      <td>8.000000</td>
      <td>3.000000</td>
      <td>5.000000</td>
      <td>2.000000</td>
      <td>-2.000000</td>
      <td>68.000000</td>
      <td>41.000000</td>
      <td>19.000000</td>
      <td>1017.000000</td>
      <td>...</td>
      <td>1011.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>7.000000</td>
      <td>14.000000</td>
      <td>6.000000</td>
      <td>35.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>66.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>20.000000</td>
      <td>14.000000</td>
      <td>9.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>2.000000</td>
      <td>87.000000</td>
      <td>59.000000</td>
      <td>32.000000</td>
      <td>1020.000000</td>
      <td>...</td>
      <td>1015.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>21.000000</td>
      <td>8.000000</td>
      <td>42.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>223.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>29.000000</td>
      <td>21.000000</td>
      <td>14.000000</td>
      <td>12.000000</td>
      <td>8.000000</td>
      <td>5.000000</td>
      <td>94.000000</td>
      <td>74.000000</td>
      <td>47.750000</td>
      <td>1024.000000</td>
      <td>...</td>
      <td>1019.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>27.000000</td>
      <td>11.000000</td>
      <td>52.000000</td>
      <td>0.000000</td>
      <td>5.000000</td>
      <td>299.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>41.000000</td>
      <td>32.000000</td>
      <td>28.000000</td>
      <td>20.000000</td>
      <td>16.000000</td>
      <td>14.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>1047.000000</td>
      <td>...</td>
      <td>1041.000000</td>
      <td>31.000000</td>
      <td>31.000000</td>
      <td>31.000000</td>
      <td>182.000000</td>
      <td>39.000000</td>
      <td>103.000000</td>
      <td>32.000000</td>
      <td>8.000000</td>
      <td>360.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 21 columns</p>
</div>

<p>The count , mean , min , and max rows are self-explanatory.  Note that the null values are ignored (so, for example, count of <code class="highlighter-rouge">Max TemperatureC</code>is 6810, not 6812). The std row shows the standard deviation, which measures how dispersed the values are. The 25%, 50%, and 75% rows show the corresponding percentiles: a percentile indicates the value below which a given percentage of observations in a group of observations falls</p>

<h3 id="looking-for-correlations">Looking for Correlations:</h3>

<p>Since the dataset is not too large, you can easily compute the standard correlation coefficient (also called Pearson’s r) between every pair of attributes using the corr() method:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="n">corr_matrix</span><span class="p">[</span><span class="s">"Max TemperatureC"</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Max TemperatureC               1.000000
Mean TemperatureC              0.970983
Min TemperatureC               0.856143
Dew PointC                     0.583509
MeanDew PointC                 0.495857
 Min VisibilitykM              0.388285
Min DewpointC                  0.329547
 Mean VisibilityKm             0.299083
 Max VisibilityKm              0.126435
 Max Wind SpeedKm/h            0.025244
WindDirDegrees                 0.000365
 Mean Sea Level PressurehPa   -0.011203
 Min Sea Level PressurehPa    -0.042676
Precipitationmm               -0.068196
 Mean Wind SpeedKm/h          -0.073119
 Max Sea Level PressurehPa    -0.081856
 Max Gust SpeedKm/h           -0.135634
 CloudCover                   -0.449610
Max Humidity                  -0.718184
 Min Humidity                 -0.761490
 Mean Humidity                -0.805961
Name: Max TemperatureC, dtype: float64
</code></pre></div></div>

<p>The correlation coefficient ranges from –1 to 1. When it is close to 1, it means that there is a strong positive correlation.  When the coefficient is close to –1, it means that there is a strong negative correlation.  Finally, coefficients close to zero mean that there is no linear correlation</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<h2 id="exploratory-data-analysis">Exploratory Data Analysis</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df1</span><span class="p">[</span><span class="s">' Events'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([nan, 'Rain', 'Rain-Snow', 'Snow', 'Fog', 'Fog-Rain',
       'Rain-Thunderstorm', 'Thunderstorm', 'Rain-Hail-Thunderstorm',
       'Fog-Thunderstorm', 'Tornado', 'Fog-Rain-Thunderstorm',
       'Fog-Rain-Snow', 'Fog-Snow', 'Rain-Snow-Thunderstorm', 'Rain-Hail'],
      dtype=object)
</code></pre></div></div>

<p>Date:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">display</span><span class="p">(</span><span class="s">'Beginning date:'</span><span class="p">,</span> <span class="n">df1</span><span class="p">[</span><span class="s">'CET'</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s">'End date:'</span><span class="p">,</span> <span class="n">df1</span><span class="p">[</span><span class="s">'CET'</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">:])</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'Beginning date:'



'1997-1-1'



'End date:'



6811    2015-12-31
Name: CET, dtype: object
</code></pre></div></div>

<p>A histogram for each numerical attribute:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([[&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f1696c43278&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f1696479438&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f169649fa90&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f169644f128&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f16963f4780&gt;],
       [&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f169641acc0&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f16963cb358&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f16963709e8&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f1696370a20&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f16963446a0&gt;],
       [&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f16962ebcf8&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f1696319390&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f16962c09e8&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f169626f080&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f16962956d8&gt;],
       [&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f169623ad30&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f16961ec3c8&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f1696210a20&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f16961bf0b8&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f16961e4710&gt;],
       [&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f1696181080&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f16961a09e8&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f169614e390&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f16960f4cf8&gt;,
        &lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f16961216a0&gt;]],
      dtype=object)
</code></pre></div></div>

<p><img src="https://drive.google.com/uc?export=view&amp;id=1Olv2HGjwXuN-3B-gykD-L0jrQ2PeiRhh" alt="png" /></p>

<p>Bar plot for categorical attribute:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">df1</span><span class="p">[</span><span class="s">' Events'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s">'bar'</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s">'Weather event'</span><span class="p">,</span> <span class="n">rot</span> <span class="o">=</span> <span class="mi">90</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">df1</span><span class="p">[</span><span class="s">' Events'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s">'pie'</span><span class="p">,</span>
                                 <span class="n">autopct</span><span class="o">=</span><span class="s">'</span><span class="si">%1.2</span><span class="s">f</span><span class="si">%%</span><span class="s">'</span><span class="p">,</span>
                                 <span class="n">shadow</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                 <span class="n">title</span> <span class="o">=</span> <span class="s">'Weather event'</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">legend</span> <span class="o">=</span> <span class="s">'bbox_to_anchor=(1.5, 2)'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://drive.google.com/uc?export=view&amp;id=1XT4i5N1ISx3Y8Ytkx87ZgaBAn_9ZORgo" alt="png" /></p>

<ul>
  <li>Madrid has on average only ~ 63.4 % precipitation from 1997 - 2015</li>
</ul>

<p>Imputing nan values:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">display</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="nb">sum</span><span class="p">())</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CET                               0
Max TemperatureC                  2
Mean TemperatureC                 3
Min TemperatureC                  2
Dew PointC                        2
MeanDew PointC                    2
Min DewpointC                     2
Max Humidity                      2
 Mean Humidity                    2
 Min Humidity                     2
 Max Sea Level PressurehPa        0
 Mean Sea Level PressurehPa       0
 Min Sea Level PressurehPa        0
 Max VisibilityKm               940
 Mean VisibilityKm              940
 Min VisibilitykM               940
 Max Wind SpeedKm/h               0
 Mean Wind SpeedKm/h              0
 Max Gust SpeedKm/h            3306
Precipitationmm                   0
 CloudCover                    1372
 Events                        5014
WindDirDegrees                    0
dtype: int64
</code></pre></div></div>

<h4 id="-recall-the-goal-is-to-use-minimum-temperature-to-predict-maximum-temperature-in-barajas-airport---madrid"><font color="darkgreen"> Recall, the goal is to use minimum temperature to predict maximum temperature in Barajas Airport - Madrid</font></h4>

<p>We shall replace nan values with the median of the column for both features:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s">"Min TemperatureC"</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s">"Min TemperatureC"</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()))</span>

<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s">"Max TemperatureC"</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df1</span><span class="p">[</span><span class="s">"Max TemperatureC"</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()))</span>

<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(6812,) (6812,)
</code></pre></div></div>

<p>Let’s make some plots:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">'.k'</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">"MaxTemp vs MinTemp"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"MinTemp"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"MaxTemp"</span><span class="p">)</span>


</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0, 0.5, 'MaxTemp')
</code></pre></div></div>

<p><img src="https://drive.google.com/uc?export=view&amp;id=1hDGjrxjUSfKAPgz85fbJU58nWar3UY8s" alt="png" /></p>

<p>Note: Looking at the figure above, it appears that there is some sort of linear relationship between minimum and maximum temperature.</p>

<p>Let’s try to inspect the maximum temperature:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f16956a47f0&gt;
</code></pre></div></div>

<p><img src="https://drive.google.com/uc?export=view&amp;id=1Xn0I6HQPir0z194e4XMXLgmW2mSp2g1I" alt="png" /></p>

<h2 id="data-splicing">Data Splicing</h2>

<p>We are going to split the data into two sets -  80$\%$ train set and 20$\%$ test set.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1">#transform from row vector to column vector
</span><span class="n">xx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="n">yy</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>

<span class="c1">#splicing
</span><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

</code></pre></div></div>

<p>Let’s check the size of all sets:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>((5449, 1), (1363, 1))
</code></pre></div></div>

<h2 id="machine-learning-model">Machine Learning model</h2>

<p>This is the part where the classifier will be instantiate and trained.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="c1">#training the algorithm
</span><span class="n">LR</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">normalize</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1">#To retrieve the intercept
</span><span class="k">print</span><span class="p">(</span><span class="s">"intercept :"</span><span class="p">,</span> <span class="n">LR</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"coefficient :"</span><span class="p">,</span> <span class="n">LR</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>intercept : [11.44633278]
coefficient : [[1.11300363]]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">LinearRegression</span><span class="err">?</span>
</code></pre></div></div>

<p>Let’s make prediction: how accurately the algorithm predict the percentage score</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y_pred</span> <span class="o">=</span> <span class="n">LR</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="model-evaluation">Model evaluation</h2>

<p>Select a Performance Measure:</p>

<p>A typical performance measure for regression problems is the <code class="highlighter-rouge">Mean Absolute Error</code>, <code class="highlighter-rouge">Mean Squared Error</code>, <code class="highlighter-rouge">Root Mean Square Error (RMSE)</code>. It gives an idea of how much error the system typically makes in its predictions.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"Mean Absolute Error:"</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Mean Squared Error:"</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Root Mean Square Error:"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Mean Absolute Error: 3.8983539895849852
Mean Squared Error: 21.24457217559518
Root Mean Square Error: 4.609183460830691
</code></pre></div></div>

<p>creating new dataframe consist of actual and predicted values:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">"Actual"</span><span class="p">:</span> <span class="n">y_test</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="s">"Predicted"</span><span class="p">:</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">flatten</span><span class="p">()})</span>

<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s"> --------------------Let us view few rows in new dataframe------------------'</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> --------------------Let us view few rows in new dataframe------------------
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Actual</th>
      <th>Predicted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17.0</td>
      <td>13.672340</td>
    </tr>
    <tr>
      <th>1</th>
      <td>28.0</td>
      <td>20.350362</td>
    </tr>
    <tr>
      <th>2</th>
      <td>24.0</td>
      <td>30.367395</td>
    </tr>
    <tr>
      <th>3</th>
      <td>27.0</td>
      <td>22.576369</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.0</td>
      <td>12.559336</td>
    </tr>
  </tbody>
</table>
</div>

<p>Let’s view few actual and predicted values:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s">'bar'</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span> <span class="o">=</span> <span class="s">'major'</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s">'-'</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="s">'0.5'</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'green'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Comparison of Predictated and Actual values'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Variables'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Values'</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0, 0.5, 'Values')
</code></pre></div></div>

<p><img src="https://drive.google.com/uc?export=view&amp;id=1NMsX7CbZ1pk5LgYqUKtFf6PHHWqh1Slp" alt="png" /></p>

<p>Let’s view our linear model</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'gray'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">'red'</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"MinTemp"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"PredTemp"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://drive.google.com/uc?export=view&amp;id=19EIFmu-JK4Km-zABf_qiUMZltIiOimwL" alt="png" /></p>

  </div>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Unarine Tshiwawa</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Unarine Tshiwawa</li>
          <li><a href="mailto:unarine.tshiwawa@gmail.com">unarine.tshiwawa@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/tshuna001"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">tshuna001</span></a>

          </li>
          

          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>
"To me success means effectiveness in the world, that I am able to carry my ideas and values into the world—that I am able to change it in positive ways."
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
